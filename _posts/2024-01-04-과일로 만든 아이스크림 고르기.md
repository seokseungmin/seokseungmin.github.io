---
title: "과일로 만든 아이스크림 고르기"
excerpt: "과일로 만든 아이스크림 고르기"

categories: SQL
tags:  SQL

permalink: /categories/과일로 만든 아이스크림 고르기/ # url

toc: true
toc_sticky: true

date: 2024-01-04
last_modified_at: 2024-01-04
---

# 과일로 만든 아이스크림 고르기
programmers SQL 고득점 kit 연습

# 아이스크림 맛 조회 SQL 문제

다음은 아이스크림 가게의 상반기 주문 정보를 담은 `FIRST_HALF` 테이블과 아이스크림 성분에 대한 정보를 담은 `ICECREAM_INFO` 테이블입니다. 

**FIRST_HALF 테이블 구조:**

| NAME        | TYPE    | NULLABLE |
|-------------|---------|----------|
| SHIPMENT_ID | INT(N)  | FALSE    |
| FLAVOR      | VARCHAR(N) | FALSE  |
| TOTAL_ORDER | INT(N)  | FALSE    |

**ICECREAM_INFO 테이블 구조:**

| NAME            | TYPE    | NULLABLE |
|-----------------|---------|----------|
| FLAVOR          | VARCHAR(N) | FALSE  |
| INGREDIENT_TYPE | VARCHAR(N) | FALSE  |

상반기 아이스크림 총주문량이 3,000보다 높으면서 아이스크림의 주 성분이 과일인 아이스크림의 맛을 총주문량이 큰 순서대로 조회하는 SQL 문을 작성해주세요.

**예시:**

예를 들어 `FIRST_HALF` 테이블이 다음과 같고

| SHIPMENT_ID | FLAVOR           | TOTAL_ORDER |
|-------------|------------------|-------------|
| 101         | chocolate        | 3200        |
| 102         | vanilla          | 2800        |
| 103         | mint_chocolate   | 1700        |
| 104         | caramel          | 2600        |
| 105         | white_chocolate  | 3100        |
| 106         | peach            | 2450        |
| 107         | watermelon       | 2150        |
| 108         | mango            | 2900        |
| 109         | strawberry       | 3100        |
| 110         | melon            | 3150        |
| 111         | orange           | 2900        |
| 112         | pineapple        | 2900        |

`ICECREAM_INFO` 테이블이 다음과 같다면

| FLAVOR          | INGREDIENT_TYPE |
|-----------------|------------------|
| chocolate       | sugar_based      |
| vanilla         | sugar_based      |
| mint_chocolate  | sugar_based      |
| caramel         | sugar_based      |
| white_chocolate | sugar_based      |
| peach           | fruit_based      |
| watermelon      | fruit_based      |
| mango           | fruit_based      |
| strawberry      | fruit_based      |
| melon           | fruit_based      |
| orange          | fruit_based      |
| pineapple       | fruit_based      |

상반기 아이스크림 총주문량이 3,000보다 높은 아이스크림 맛은 chocolate, strawberry, melon, white_chocolate입니다. 
이 중에 아이스크림의 주 성분이 과일인 아이스크림 맛은 strawberry와 melon이고 총주문량이 큰 순서대로 아이스크림 맛을 조회하면 melon, strawberry 순으로 조회되어야 합니다. 
따라서 SQL 문을 실행하면 다음과 같이 나와야 합니다.

**결과:**

| FLAVOR  |
|---------|
| melon   |
| strawberry |

```sql
SELECT FH.FLAVOR
FROM FIRST_HALF FH
JOIN ICECREAM_INFO ICI ON FH.FLAVOR = ICI.FLAVOR
WHERE TOTAL_ORDER > 3000 
AND INGREDIENT_TYPE = 'fruit_based'
ORDER BY TOTAL_ORDER DESC;
```
