---
layout: single
title: "의존객체 자동 주입"
excerpt: "의존객체 자동 주입"

categories: Spring
tags: Spring

permalink: /categories/의존객체 자동 주입/ # url

toc: true
toc_sticky: true

date: 2024-01-09
last_modified_at: 2024-01-09
---

# 의존객체 자동 주입

<center><img src="/assets/images/posts_img/readme/의존객체자동주입.png" width="100%" height="100%"></center>

의존 객체 자동 주입이란?
스프링 설정 파일에서 의존 객체를 주입할 때(constructor-org) 또는 <property> 태그로 의존 대상 객체를<br>
명시하지 않아도 스프링 컨테이너가 자동으로 필요한 의존 대상 객체를 찾아서 <br>
의존 대상 객체가 필요한 객체에 주입해 주는 기능이다.
구현 방법은 @Autowired와 @Resource 어노테이션을 이용해서 쉽게 구현할 수 있다.

# @Autowired
객체 타입을 보고 자동으로 객체를 넣어준다.
<center><img src="/assets/images/posts_img/readme/Autowired.png" width="100%" height="100%"></center>

## appCtx.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
 		http://www.springframework.org/schema/beans/spring-beans.xsd">

	<bean id="wordDao" class="com.word.dao.WordDao" />
	
	<bean id="registerService" class="com.word.service.WordRegisterService">
		<constructor-arg ref="wordDao" />
	</bean>
	
	<bean id="searchService" class="com.word.service.WordSearchService">
		<constructor-arg ref="wordDao" />
	</bean>
	
</beans>
```

## WordDao.java

```java
package com.word.dao;

import java.util.HashMap;
import java.util.Map;

import com.word.WordSet;

public class WordDao {

	private Map<String, WordSet> wordDB = 
			new HashMap<String, WordSet>();

	public void insert(WordSet wordSet) {
		wordDB.put(wordSet.getWordKey(), wordSet);
	}

	public WordSet select(String wordKey) {
		return wordDB.get(wordKey);
	}

	public void update(WordSet wordKey) {
		wordDB.put(wordKey.getWordKey(), wordKey);
	}

	public void delete(String sNum) {
		wordDB.remove(sNum);
	}

	public Map<String, WordSet> getWordDB() {
		return wordDB;
	}

}
```

## WordSet.java

```java
package com.word;

public class WordSet {

	private String wordKey;
	private String wordValue;
	
	public WordSet(String wordKey, String wordValue) {
		this.wordKey = wordKey;
		this.wordValue = wordValue;
	}

	public String getWordKey() {
		return wordKey;
	}

	public void setWordKey(String wordKey) {
		this.wordKey = wordKey;
	}

	public String getWordValue() {
		return wordValue;
	}

	public void setWordValue(String wordValue) {
		this.wordValue = wordValue;
	}
	
}
```

## WordRegisterService.java

```java
package com.word.service;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordRegisterService {

	private WordDao wordDao;
	
	public WordRegisterService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public void register(WordSet wordSet) {
		String wordKey = wordSet.getWordKey();
		if(verify(wordKey)) {
			wordDao.insert(wordSet);
		} else {
			System.out.println("The word has already registered.");
		}
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet == null ? true : false;
	}
	
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

## WordSearchService.java

```java
package com.word.service;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordSearchService {
	
	private WordDao wordDao;
	
	public WordSearchService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public WordSet searchWord(String wordKey) {
		if(verify(wordKey)) {
			return wordDao.select(wordKey);
		} else {
			System.out.println("WordKey information is available.");
		}
		
		return null;
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet != null ? true : false;
	}
	
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

## MainClass.java

```java
package com.word;

import org.springframework.context.support.GenericXmlApplicationContext;

import com.word.service.WordRegisterService;
import com.word.service.WordSearchService;

public class MainClass {

	public static void main(String[] args) {
		
		String[] keyWords = {"c", "c++", "java", "jsp",  "spring"};
		String[] values = {"C는 1972년 켄 톰슨과 데니스 리치가 유닉스 운영 체제에서 사용하기 위해 개발한 프로그래밍 언어이다.", 
				"C++는 AT&T 벨 연구소의 비야네 스트롭스트룹이 1983년 발표하여 발전한 프로그래밍 언어이다.", 
				"자바는 썬 마이크로시스템즈의 제임스 고슬링(James Gosling)과 다른 연구원들이 개발한 객체 지향적 프로그래밍 언어이다.", 
				"JSP는 HTML내에 자바 코드를 삽입하여 웹 서버에서 동적으로 웹 페이지를 생성하여 웹 브라우저에 돌려주는 언어이다.", 
				"스프링 프레임워크는 자바 플랫폼을 위한 오픈소스 애플리케이션 프레임워크로서 간단히 스프링이라고도 불린다."};
		
		GenericXmlApplicationContext ctx = 
				new GenericXmlApplicationContext("classpath:appCtx.xml");
		
		WordRegisterService registerService = 
				ctx.getBean("registerService", WordRegisterService.class);
		for (int i = 0; i < values.length; i++) {
			WordSet wordSet = new WordSet(keyWords[i], values[i]);
			registerService.register(wordSet);
		}
		
		WordSearchService searchService = 
				ctx.getBean("searchService", WordSearchService.class);
		
		System.out.println("\n\n------------------------------------");
		for (int i = 0; i < keyWords.length; i++) {
			WordSet wordSet = searchService.searchWord(keyWords[i]);
			System.out.print(wordSet.getWordKey() + "\t: ");
			System.out.println(wordSet.getWordValue());
			System.out.println("[출처:위키피디아(https://www.wikipedia.org/)]");
			System.out.println("------------------------------------");
		}
		System.out.println("\n\n");
		
		ctx.close();
		
	}
	
}
```

```
기존에는 이와같이 의존객체주입을 받았지만
<bean id="registerService" class="com.word.service.WordRegisterService">
		<constructor-arg ref="wordDao" />
</bean>
이 부분에서 <constructor-arg ref="wordDao" />를 주석처리하고

public WordRegisterService(WordDao wordDao) {
	this.wordDao = wordDao;
}
이 부분위에 @Autowired를 추가하면 같은 기능을 수행함.

@Autowired
public WordRegisterService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
이렇게! appCtx.xml 여기서 설정을 해주지 않았지만, 여기서 알아서 스프링 컨테이너에서는
개체 생성되려고 그러는데, 자동으로 좀 찾아줘라고 스프링컨테이너한테 얘기를 함.
그럼 스프링컨테이너에서는 자기 안에 있는 객체중 WordDao라는 타입을 갖고 있는 객체를 찾아요.
찾아서 알아서 넣어준다는 얘기입니다.
```

## appCtxUseAutowired.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
 		http://www.springframework.org/schema/beans/spring-beans.xsd 
 		http://www.springframework.org/schema/context 
 		http://www.springframework.org/schema/context/spring-context.xsd">

	<context:annotation-config />

	<bean id="wordDao" class="com.word.dao.WordDao" >
		<!-- <qualifier value="usedDao"/> -->
	</bean>
	<bean id="wordDao2" class="com.word.dao.WordDao" />
	<bean id="wordDao3" class="com.word.dao.WordDao" />
	
	<bean id="registerService" class="com.word.service.WordRegisterServiceUseAutowired" />
	
	<bean id="searchService" class="com.word.service.WordSearchServiceUseAutowired" />
	
</beans>
```

```
Autowired를 쓸때 위에 처럼만 해서는 사실 안되고, 어떤 namespace 라던가, 어떤 태그를 하나 넣어줄 필요가 있음.
<context:annotation-config /> 이라는 태그를 넣어줘야함.
namespace ->
http://www.springframework.org/schema/beans/spring-beans.xsd 
http://www.springframework.org/schema/context 
스키마 ->
xmlns:context="http://www.springframework.org/schema/context"
를 추가해줘야함.  어노테이션을 사용하기 위해서는 굉장히 많은, 생각보다 많은 클래스 파일들을 필요로함.
이런 클래스 파일들을 개발자들이 직접 코딩할 필요없이 자동으로 스프링 프레임워크에서 제공해 주는것을
이용할 수 있겠는데 그렇게 이용하는 것을 쓰려면 annotation-config를 써야함.
annotation-config를 이용하기 위해서는 네임스페이스와 스키마를 명시해줘야함.
이런 내용을 직접 코딩하기 보단 기존에 코드를 재활용해서 해결하는 방법을 추천함.

```

## appCtxUseAutowired.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
 		http://www.springframework.org/schema/beans/spring-beans.xsd 
 		http://www.springframework.org/schema/context 
 		http://www.springframework.org/schema/context/spring-context.xsd">

	<context:annotation-config />

	<bean id="wordDao" class="com.word.dao.WordDao" >
		<!-- <qualifier value="usedDao"/> -->
	</bean>
	<bean id="wordDao2" class="com.word.dao.WordDao" />
	<bean id="wordDao3" class="com.word.dao.WordDao" />
	
	<bean id="registerService" class="com.word.service.WordRegisterServiceUseAutowired" />
	
	<bean id="searchService" class="com.word.service.WordSearchServiceUseAutowired" />
	
</beans>
```

## WordRegisterServiceUseAutowired.java

```java
package com.word.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordRegisterServiceUseAutowired {

	@Autowired
//	@Qualifier("usedDao")
	private WordDao wordDao;
	
	public WordRegisterServiceUseAutowired() {
		// TODO Auto-generated constructor stub
	}
	
//	@Autowired
	public WordRegisterServiceUseAutowired(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public void register(WordSet wordSet) {
		String wordKey = wordSet.getWordKey();
		if(verify(wordKey)) {
			wordDao.insert(wordSet);
		} else {
			System.out.println("The word has already registered.");
		}
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet == null ? true : false;
	}
	
//	@Autowired
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

## WordSearchServiceUseAutowired.java

```java
package com.word.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordSearchServiceUseAutowired {
	
	@Autowired
//	@Qualifier("usedDao")
	private WordDao wordDao;
	
	public WordSearchServiceUseAutowired() {
		// TODO Auto-generated constructor stub
	}
	
//	@Autowired
	public WordSearchServiceUseAutowired(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public WordSet searchWord(String wordKey) {
		if(verify(wordKey)) {
			return wordDao.select(wordKey);
		} else {
			System.out.println("WordKey information is available.");
		}
		
		return null;
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet != null ? true : false;
	}
	
//	@Autowired
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

## 주의사항
Default Constructor: @Autowired를 사용할 때는 기본 생성자가 필요합니다.
이는 Spring이 빈을 인스턴스화할 때 필요한 것으로, 프로퍼티 또는 메서드에 @Autowired를 사용할 경우 반드시 기본 생성자를 제공해야 합니다.

Qualifier 사용: @Qualifier 주석은 주입되는 빈이 여러 개 있을 경우, 어떤 빈을 사용할지 지정하는 데 사용됩니다. 
여기서는 주석 처리되어 있지만, 필요에 따라 활성화할 수 있습니다.

MainClass.java에서 GenericXmlApplicationContext ctx = new GenericXmlApplicationContext("classpath:appCtx.xml"); 를
GenericXmlApplicationContext ctx = new GenericXmlApplicationContext("classpath:appCtxUseAutowired.xml"); 로 수정해서 
사용하면 Autowired를 이용한 방법을 사용할수 있음.

# 참고
```
프로퍼티나 메서드에 @Autowired 쓰고 싶다 그럴때는 반드시 디폴트 생성자를 명시를 해줘야함.
이유는 이 객체가 생성되야지 그 다음에 프로퍼티에서 wordDao를 끌어올수가 있겠고 다음에 
@Autowired
public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
이런 메서드에 wordDao를 파라미터에 넣어서 wordDao,
this.wordDao 객체를 넣어줄 수가 있겠죠. 근데 디폴트 생성자가 없이
public WordRegisterService(WordDao wordDao) {
	this.wordDao = wordDao;
}
파라미터가 지금 하나 있는 생성자가 있는데요, 그러면 생성을 하고자 할때 WordDao wordDao이걸 가지고 생성을 하는데 얘를 못 찾겠죠.
@Autowired가 없으니까 그래서 에러가 납니다. 그래서 반드시 생성자에 @Autowired를 해서 자동 주입을 한다 그럴때는 상관이 없는데
프로퍼티(private WordDao wordDao)라던가 메서드에 @Autowired를 준다고 할때는 반드시 디폴트 생성자를 하나 꼭 명시를 해줘야 한다는거 알아두시면 됩니다.
```

## ChatGPT 상세 설명 요약
```
스프링 프레임워크에서 @Autowired 주석을 프로퍼티나 메서드에 사용할 때 기본 생성자(Default Constructor)를 명시하는 것이 중요한 이유는 스프링의 의존성 주입(Dependency Injection) 메커니즘과 객체 생성 과정에 기반합니다.

의존성 주입과 객체 생성
객체 생성: 스프링 컨테이너는 빈(Bean)을 생성할 때 클래스의 생성자를 호출합니다.
만약 클래스에 파라미터를 받는 생성자가 있고, 기본 생성자가 없다면, 스프링은 어떻게 해당 객체를 인스턴스화해야 하는지 알 수 없습니다.
따라서, 기본 생성자가 있으면 스프링은 이를 사용하여 객체를 생성할 수 있습니다.

의존성 주입: 객체가 생성된 후, 스프링은 @Autowired로 표시된 필드나 메서드에 필요한 의존성을 주입합니다. 이 과정은 객체가 이미 생성된 후에 이루어집니다.

기본 생성자의 필요성
빈 인스턴스화: 스프링은 빈의 인스턴스를 생성할 때 기본 생성자를 사용합니다.
만약 기본 생성자가 없고, 다른 생성자에 @Autowired가 없으면, 스프링은 객체를 인스턴스화하는 방법을 모릅니다.
따라서 에러가 발생할 수 있습니다.

선택적 의존성 주입: @Autowired 주석이 붙은 메서드나 필드에 의존성을 주입하는 것은 객체가 이미 생성된 후에 이루어집니다.
따라서 기본 생성자를 통해 객체를 먼저 생성한 다음, 필요한 의존성을 주입할 수 있어야 합니다.

유연성: 기본 생성자를 제공함으로써, 스프링은 생성자 주입(Constructor Injection)과 세터 주입(Setter Injection)을 포함한
다양한 방법으로 의존성을 주입할 수 있는 유연성을 갖게 됩니다.

결론
따라서, @Autowired를 프로퍼티나 메서드에 사용할 때 기본 생성자를 제공하는 것은 스프링 컨테이너가 객체를 적절히 인스턴스화하고,
필요한 의존성을 주입할 수 있도록 하는 데 필수적입니다.
이는 스프링의 제어 역전(IoC: Inversion of Control) 원칙과 의존성 주입(DI: Dependency Injection) 패턴을 효율적으로 활용하기 위한 필수 조건입니다.
```

# @Resource

<center><img src="/assets/images/posts_img/readme/Resource.png" width="100%" height="100%"></center>

## WordRegisterServiceUseResource.java

```java
package com.word.service;

import javax.annotation.Resource;

import org.springframework.beans.factory.annotation.Qualifier;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordRegisterServiceUseResource {

	@Resource
//	@Qualifier("usedDao")
	private WordDao wordDao;
	
	public WordRegisterServiceUseResource() {
		
	}
	
	//@Resource
	public WordRegisterServiceUseResource(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public void register(WordSet wordSet) {
		String wordKey = wordSet.getWordKey();
		if(verify(wordKey)) {
			wordDao.insert(wordSet);
		} else {
			System.out.println("The word has already registered.");
		}
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet == null ? true : false;
	}
	
	//@Resource
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

## appCtxUseResource.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
 		http://www.springframework.org/schema/beans/spring-beans.xsd 
 		http://www.springframework.org/schema/context 
 		http://www.springframework.org/schema/context/spring-context.xsd">

	<context:annotation-config />

	<bean id="wordDao" class="com.word.dao.WordDao" >
		<!-- <qualifier value="usedDao"/> -->
	</bean>
	<bean id="wordDao2" class="com.word.dao.WordDao" />
	<bean id="wordDao3" class="com.word.dao.WordDao" />
	
	<bean id="registerService" class="com.word.service.WordRegisterServiceUseResource" />
	
	<bean id="searchService" class="com.word.service.WordSearchServiceUseResource" />
	
</beans>
```


```
@Autowired랑 비슷하지만 스프링 컨테이너에서 스프링 컨테이너에 만들어진 빈 객체중에 객체의 타입을 보는것이 Autowired라면
객체의 이름을 보는게 리소스임. WordDao와 똑같은 이름이 있는지를 찾아서 그 이름을 찾아서 객체를 자동으로 주입을 해줌.
WordDao wordDao랑 똑같은 이름 <bean id="wordDao" class="com.word.dao.WordDao" > 을 찾아서 주입함.
@Resource는 생성자에는 쓰지못함. 프로퍼티 또는 메서드에 사용가능. 이 때도 프로퍼티 또는 메서드에 @Resource 사용할 경우 반드시 기본 생성자를 제공해야 합니다.
```
