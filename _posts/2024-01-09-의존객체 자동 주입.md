---
layout: single
title: "의존객체 자동 주입"
excerpt: "의존객체 자동 주입"

categories: Spring
tags: Spring

permalink: /categories/의존객체 자동 주입/ # url

toc: true
toc_sticky: true

date: 2024-01-09
last_modified_at: 2024-01-09
---

# 의존객체 자동 주입

<center><img src="/assets/images/posts_img/readme/의존객체자동주입.png" width="100%" height="100%"></center>

의존 객체 자동 주입이란?
스프링 설정 파일에서 의존 객체를 주입할 때(constructor-org) 또는 <property> 태그로 의존 대상 객체를<br>
명시하지 않아도 스프링 컨테이너가 자동으로 필요한 의존 대상 객체를 찾아서 <br>
의존 대상 객체가 필요한 객체에 주입해 주는 기능이다.
구현 방법은 @Autowired와 @Resource 어노테이션을 이용해서 쉽게 구현할 수 있다.

# @Autowired
객체 타입을 보고 자동으로 객체를 넣어준다.
<center><img src="/assets/images/posts_img/readme/Autowired.png" width="100%" height="100%"></center>

## appCtx.xml

```
기존에
<bean id="registerService" class="com.word.service.WordRegisterService">
		<constructor-arg ref="wordDao" />
</bean>
이 부분에서 <constructor-arg ref="wordDao" />를 주석처리하고

	public WordRegisterService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
이 부분위에 @Autowired를 추가하면 같은 기능을 수행함.

 @Autowired
public WordRegisterService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
이렇게! appCtx.xml 여기서 설정을 해주지 않았지만, 여기서 알아서 스프링 컨테이너에서는
개체 생성되려고 그러는데 AutoWired, 자동으로 좀 찾아주래라고 스프링컨테이너한테 얘기를 함.
그럼 스프링컨테이너에서는 자기 안에 있는 객체중 WordDao라는 타입을 갖고 있는 객체를 찾아요.
찾서 알아서 넣어준다는 얘기입니다.
```

```xml
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
 		http://www.springframework.org/schema/beans/spring-beans.xsd">

	<bean id="wordDao" class="com.word.dao.WordDao" />
	
	<bean id="registerService" class="com.word.service.WordRegisterService">
		<constructor-arg ref="wordDao" />
	</bean>
	
	<bean id="searchService" class="com.word.service.WordSearchService">
		<constructor-arg ref="wordDao" />
	</bean>
	
</beans>
```

```java
package com.word.service;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordRegisterService {

	private WordDao wordDao;
	
	public WordRegisterService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public void register(WordSet wordSet) {
		String wordKey = wordSet.getWordKey();
		if(verify(wordKey)) {
			wordDao.insert(wordSet);
		} else {
			System.out.println("The word has already registered.");
		}
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet == null ? true : false;
	}
	
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

## appCtxUseAutowired.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
 		http://www.springframework.org/schema/beans/spring-beans.xsd 
 		http://www.springframework.org/schema/context 
 		http://www.springframework.org/schema/context/spring-context.xsd">

	<context:annotation-config />

	<bean id="wordDao" class="com.word.dao.WordDao" >
		<!-- <qualifier value="usedDao"/> -->
	</bean>
	<bean id="wordDao2" class="com.word.dao.WordDao" />
	<bean id="wordDao3" class="com.word.dao.WordDao" />
	
	<bean id="registerService" class="com.word.service.WordRegisterServiceUseAutowired" />
	
	<bean id="searchService" class="com.word.service.WordSearchServiceUseAutowired" />
	
</beans>
```

```
Autowired를 쓸때 위에 처럼만 해서는 사실 안되고, 어떤 namespace 라던가, 어떤 태그를 하나 넣어줄 필요가 있음.
<context:annotation-config /> 이라는 태그를 넣어줘야함.
namespace ->
http://www.springframework.org/schema/beans/spring-beans.xsd 
http://www.springframework.org/schema/context 
스키마 ->
xmlns:context="http://www.springframework.org/schema/context"
를 추가해줘야함.  어노테이션을 사용하기 위해서는 굉장히 많은, 생각보다 많은 클래스 파일들을 필요로함.
이런 클래스 파일들을 개발자들이 직접 코딩할 필요없이 자동으로 스프링 프레임워크에서 제공해 주는것을
이용할 수 있겠는데 그렇게 이용하는 것을 쓰려면 어노테이션 컨피그를 써야함.
어노테이션 컨피그를 이용하기 위해서는 네임스페이스와 스키마를 명시해줘야함.
이런 내용을 직접 코딩하기 보단 기존에 코드를 재활용해서 해결하는 방법을 추천함.

```

## WordSearchServiceUseAutowired.java

```java
package com.word.service;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordSearchServiceUseAutowired {
	
	@Autowired
//	@Qualifier("usedDao")
	private WordDao wordDao;
	
	public WordSearchServiceUseAutowired() {
		// TODO Auto-generated constructor stub
	}
	
//	@Autowired
	public WordSearchServiceUseAutowired(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public WordSet searchWord(String wordKey) {
		if(verify(wordKey)) {
			return wordDao.select(wordKey);
		} else {
			System.out.println("WordKey information is available.");
		}
		
		return null;
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet != null ? true : false;
	}
	
//	@Autowired
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

주의사항
Default Constructor: @Autowired를 사용할 때는 기본 생성자가 필요합니다.
이는 Spring이 빈을 인스턴스화할 때 필요한 것으로, 프로퍼티 또는 메서드에 @Autowired를 사용할 경우 반드시 기본 생성자를 제공해야 합니다.

Qualifier 사용: @Qualifier 주석은 주입되는 빈이 여러 개 있을 경우, 어떤 빈을 사용할지 지정하는 데 사용됩니다. 
여기서는 주석 처리되어 있지만, 필요에 따라 활성화할 수 있습니다.

## WordRegisterService.java

```java
package com.word.service;

import com.word.WordSet;
import com.word.dao.WordDao;

public class WordRegisterService {
  @Autowired
	private WordDao wordDao;
	
	public WordRegisterService(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
	public void register(WordSet wordSet) {
		String wordKey = wordSet.getWordKey();
		if(verify(wordKey)) {
			wordDao.insert(wordSet);
		} else {
			System.out.println("The word has already registered.");
		}
	}
	
	public boolean verify(String wordKey){
		WordSet wordSet = wordDao.select(wordKey);
		return wordSet == null ? true : false;
	}
	@Autowired
	public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
	
}
```

# 참고
```
어노테이션 오토와이어드를 쓸 때, 프로퍼티나 메서드에 쓰고 싶다 그럴때는 반드시 디폴트 생성자를 명시를 해줘야함.
이유는 이 객체가 생성되야지 그다음에 프로퍼티에서 워드다우를 끌어올수가 있겠고 다음에 
@Autowired
public void setWordDao(WordDao wordDao) {
		this.wordDao = wordDao;
	}
이런 메서드에 워드다오를 파라미터에 넣어서 워드다오,
디스워드다오 객체를 넣어줄 수가 있겠죠. 근데 디폴트 생성자가 없이
  public WordRegisterService(WordDao wordDao) {
  this.wordDao = wordDao;
  }
파라미터가 지금 하나 있는 생성자인데요. 이런 생성자가 있다. 그러면 생성을 하고 WordDao wordDao이걸 가지고 생성을 하는데 얘를 못 찾겠죠.
오토와이어드가 없으니까 그래서 에러가 납니다. 그래서 반드시 생성자에에 오토와이어드를 해서 자동주입을 한다 그럴때는 상관이 없는데
프로퍼티(private WordDao wordDao)라던가 메서드에 오토와이어드를 준다고 할때는 반드시 디폴트 생성자를 하나 꼭 명시를 해줘야 한다는거 알아두시면 됩니다.
```

# @Resource

<center><img src="/assets/images/posts_img/readme/Resource.png" width="100%" height="100%"></center>

오토와이어드랑 비슷하지만 스프링컨테이너에서 스프링 컨테이너에 만들어진 빈 객체중에 객체의 타입을 보는것이 오토와이어드라면
객체의 이름을 보는게 리소스임. WordDao와 똑같은 이름이 있는지를 찾아서 그 이름을 찾아서 객체를 자동으로 주입을 해줌.
WordDao wordDao랑 똑같은 이름 <bean id="wordDao" class="com.word.dao.WordDao" > 을 찾아서 주입함.
리소스는 생성자에는 쓰지못함. 프로퍼티 또는 메서드에 사용가능.
