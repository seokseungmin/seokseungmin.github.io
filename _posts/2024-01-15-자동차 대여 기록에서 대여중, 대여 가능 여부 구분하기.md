---
title: "자동차 대여 기록에서 대여중, 대여 가능 여부 구분하기"
excerpt: "자동차 대여 기록에서 대여중, 대여 가능 여부 구분하기"

categories: SQL
tags:  SQL

permalink: /categories/자동차 대여 기록에서 대여중, 대여 가능 여부 구분하기/ # url

toc: true
toc_sticky: true

date: 2024-01-15
last_modified_at: 2024-01-15
---

# 자동차 대여 기록에서 대여중, 대여 가능 여부 구분하기

programmers SQL 고득점 kit 연습

## 자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기

### 문제 설명
어느 자동차 대여 회사의 자동차 대여 기록 정보를 담은 `CAR_RENTAL_COMPANY_RENTAL_HISTORY` 테이블이 있습니다. 이 테이블의 구조는 다음과 같습니다:

| Column name | Type    | Nullable |
|-------------|---------|----------|
| HISTORY_ID  | INTEGER | FALSE    |
| CAR_ID      | INTEGER | FALSE    |
| START_DATE  | DATE    | FALSE    |
| END_DATE    | DATE    | FALSE    |

### 문제
`CAR_RENTAL_COMPANY_RENTAL_HISTORY` 테이블에서 2022년 10월 16일에 대여 중인 자동차를 '대여중'으로 표시하고, 대여 중이지 않은 자동차를 '대여 가능'으로 표시하는 컬럼(`AVAILABILITY`)을 추가하여 자동차 ID와 함께 출력하는 SQL문을 작성하라는 요청입니다. 결과는 자동차 ID를 기준으로 내림차순 정렬해야 합니다.

### 예시
예를 들어, `CAR_RENTAL_COMPANY_RENTAL_HISTORY` 테이블에 다음과 같은 데이터가 있다고 가정합니다:

| HISTORY_ID | CAR_ID | START_DATE | END_DATE   |
|------------|--------|------------|------------|
| 1          | 4      | 2022-09-27 | 2022-09-27 |
| 2          | 3      | 2022-10-03 | 2022-10-04 |
| 3          | 2      | 2022-10-05 | 2022-10-05 |
| 4          | 1      | 2022-10-11 | 2022-10-16 |
| 5          | 3      | 2022-10-13 | 2022-10-15 |
| 6          | 2      | 2022-10-15 | 2022-10-17 |

이 경우, 2022년 10월 16일에 대여 중인 자동차는 자동차 ID가 1, 2인 자동차이며, 대여 가능한 자동차는 자동차 ID가 3, 4입니다. 따라서 요구되는 출력은 다음과 같습니다:

| CAR_ID | AVAILABILITY |
|--------|--------------|
| 4      | 대여 가능    |
| 3      | 대여 가능    |
| 2      | 대여중       |
| 1      | 대여중       |

```sql
SELECT CAR_ID, 
MAX(      CASE 
           WHEN '2022-10-16' BETWEEN START_DATE AND END_DATE THEN '대여중' 
           ELSE '대여 가능' 
           END) AS AVAILABILITY
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
ORDER BY CAR_ID DESC;
```
