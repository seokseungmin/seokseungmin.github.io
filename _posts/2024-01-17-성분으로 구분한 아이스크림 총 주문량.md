---
title: "성분으로 구분한 아이스크림 총 주문량"
excerpt: "성분으로 구분한 아이스크림 총 주문량"

categories: SQL
tags:  SQL

permalink: /categories/성분으로 구분한 아이스크림 총 주문량/ # url

toc: true
toc_sticky: true

date: 2024-01-17
last_modified_at: 2024-01-17
---

# 성분으로 구분한 아이스크림 총 주문량

programmers SQL 고득점 kit 연습

### 문제 설명

다음은 아이스크림 가게의 상반기 주문 정보를 담은 `FIRST_HALF` 테이블과 아이스크림 성분에 대한 정보를 담은 `ICECREAM_INFO` 테이블입니다.

#### `FIRST_HALF` 테이블 구조
- `SHIPMENT_ID` (INT(N), Not Nullable): 아이스크림 공장에서 아이스크림 가게까지의 출하 번호
- `FLAVOR` (VARCHAR(N), Not Nullable): 아이스크림 맛
- `TOTAL_ORDER` (INT(N), Not Nullable): 상반기 아이스크림 총주문량
- 기본 키: `FLAVOR`

#### `ICECREAM_INFO` 테이블 구조
- `FLAVOR` (VARCHAR(N), Not Nullable): 아이스크림 맛
- `INGREDIENT_TYPE` (VARCHAR(N), Not Nullable): 아이스크림의 성분 타입 (`sugar_based` 또는 `fruit_based`)
- 기본 키: `FLAVOR`
- `ICECREAM_INFO` 테이블의 `FLAVOR`는 `FIRST_HALF` 테이블의 `FLAVOR`의 외래 키

#### 문제
상반기 동안 각 아이스크림 성분 타입과 성분 타입에 대한 아이스크림의 총주문량을 총주문량이 작은 순서대로 조회하는 SQL 문을 작성해주세요. 이때 총주문량을 나타내는 컬럼명은 `TOTAL_ORDER`로 지정해주세요.

#### 예시
예를 들어 `FIRST_HALF` 테이블과 `ICECREAM_INFO` 테이블이 다음과 같습니다:

`FIRST_HALF` 테이블:

| SHIPMENT_ID | FLAVOR          | TOTAL_ORDER |
|-------------|-----------------|-------------|
| 101         | chocolate       | 3200        |
| ...         | ...             | ...         |
| 112         | pineapple       | 2900        |

`ICECREAM_INFO` 테이블:

| FLAVOR          | INGREDIENT_TYPE |
|-----------------|-----------------|
| chocolate       | sugar_based     |
| ...             | ...             |
| pineapple       | fruit_based     |

상반기에 아이스크림의 주 성분이 설탕인 아이스크림들에 대한 총주문량은 13,400, 과일인 아이스크림들에 대한 총주문량은 19,550입니다. 따라서 총주문량이 작은 순서대로 조회하는 SQL 문을 실행하면 다음과 같이 나와야 합니다:

| INGREDIENT_TYPE | TOTAL_ORDER |
|-----------------|-------------|
| sugar_based     | 13400       |
| fruit_based     | 19550       |

```sql
SELECT INGREDIENT_TYPE, SUM(TOTAL_ORDER) AS TOTAL_ORDER
FROM FIRST_HALF JOIN ICECREAM_INFO
ON FIRST_HALF.FLAVOR = ICECREAM_INFO.FLAVOR
GROUP BY INGREDIENT_TYPE
ORDER BY TOTAL_ORDER ASC;
```
