---
title: "카테고리 별 도서 판매량 집계하기"
excerpt: "카테고리 별 도서 판매량 집계하기"

categories: SQL
tags:  SQL

permalink: /categories/카테고리 별 도서 판매량 집계하기/ # url

toc: true
toc_sticky: true

date: 2024-01-12
last_modified_at: 2024-01-12
---

# 카테고리 별 도서 판매량 집계하기

programmers SQL 고득점 kit 연습

## 문제 설명

### 테이블 구조

#### BOOK 테이블

| Column name     | Type        | Nullable | Description  |
|-----------------|-------------|----------|--------------|
| `BOOK_ID`       | INTEGER     | FALSE    | 도서 ID      |
| `CATEGORY`      | VARCHAR(N)  | FALSE    | 카테고리 (경제, 인문, 소설, 생활, 기술) |
| `AUTHOR_ID`     | INTEGER     | FALSE    | 저자 ID      |
| `PRICE`         | INTEGER     | FALSE    | 판매가 (원)  |
| `PUBLISHED_DATE`| DATE        | FALSE    | 출판일       |

#### BOOK_SALES 테이블

| Column name | Type    | Nullable | Description  |
|-------------|---------|----------|--------------|
| `BOOK_ID`   | INTEGER | FALSE    | 도서 ID      |
| `SALES_DATE`| DATE    | FALSE    | 판매일       |
| `SALES`     | INTEGER | FALSE    | 판매량       |

### 문제

2022년 1월의 카테고리 별 도서 판매량을 합산하고, 카테고리(`CATEGORY`), 총 판매량(`TOTAL_SALES`) 리스트를 출력하는 SQL문을 작성해주세요. 결과는 카테고리명을 기준으로 오름차순 정렬해주세요.

### 예시 데이터

#### BOOK 테이블 예시

| BOOK_ID | CATEGORY | AUTHOR_ID | PRICE | PUBLISHED_DATE |
|---------|----------|-----------|-------|----------------|
| 1       | 인문     | 1         | 10000 | 2020-01-01     |
| 2       | 경제     | 1         | 9000  | 2021-02-05     |
| 3       | 경제     | 2         | 9000  | 2021-03-11     |

#### BOOK_SALES 테이블 예시

| BOOK_ID | SALES_DATE | SALES |
|---------|------------|-------|
| 1       | 2022-01-01 | 2     |
| 2       | 2022-01-02 | 3     |
| 1       | 2022-01-05 | 1     |
| 2       | 2022-01-20 | 5     |
| 2       | 2022-01-21 | 6     |
| 3       | 2022-01-22 | 2     |
| 2       | 2022-02-11 | 3     |

### 결과 예시

#### 카테고리 별 총 판매량

| CATEGORY | TOTAL_SALES |
|----------|-------------|
| 인문     | 3           |
| 경제     | 16          |

#### 카테고리명 기준 오름차순 정렬 결과

| CATEGORY | TOTAL_SALES |
|----------|-------------|
| 경제     | 16          |
| 인문     | 3           |

```sql
SELECT CATEGORY, SUM(SALES) AS TOTAL_SALES
FROM BOOK 
JOIN BOOK_SALES ON BOOK.BOOK_ID = BOOK_SALES.BOOK_ID
WHERE DATE_FORMAT(SALES_DATE,'%Y-%m') = '2022-01'
GROUP BY CATEGORY
ORDER BY CATEGORY ASC;
```
