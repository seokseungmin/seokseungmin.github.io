---
title: "오프라인|온라인 판매 데이터 통합하기"
excerpt: "오프라인|온라인 판매 데이터 통합하기"

categories: SQL
tags:  SQL

permalink: /categories/오프라인|온라인 판매 데이터 통합하기/ # url

toc: true
toc_sticky: true

date: 2024-01-08
last_modified_at: 2024-01-08
---

# 오프라인|온라인 판매 데이터 통합하기
programmers SQL 고득점 kit 연습

**의류 쇼핑몰의 온라인 및 오프라인 상품 판매 정보**

두 가지 테이블이 있습니다: `ONLINE_SALE`과 `OFFLINE_SALE`.

1. **ONLINE_SALE 테이블 구조:**

   | Column name    | Type    | Nullable |
   | -------------- | ------- | -------- |
   | ONLINE_SALE_ID | INTEGER | FALSE    |
   | USER_ID        | INTEGER | FALSE    |
   | PRODUCT_ID     | INTEGER | FALSE    |
   | SALES_AMOUNT   | INTEGER | FALSE    |
   | SALES_DATE     | DATE    | FALSE    |

   각 컬럼은 다음을 나타냅니다: 온라인 상품 판매 ID, 회원 ID, 상품 ID, 판매량, 판매일. 동일한 날짜, 회원 ID, 상품 ID 조합에 대해서는 하나의 판매 데이터만 존재합니다.

2. **OFFLINE_SALE 테이블 구조:**

   | Column name     | Type    | Nullable |
   | --------------- | ------- | -------- |
   | OFFLINE_SALE_ID | INTEGER | FALSE    |
   | PRODUCT_ID      | INTEGER | FALSE    |
   | SALES_AMOUNT    | INTEGER | FALSE    |
   | SALES_DATE      | DATE    | FALSE    |

   각 컬럼은 다음을 나타냅니다: 오프라인 상품 판매 ID, 상품 ID, 판매량, 판매일. 동일한 날짜, 상품 ID 조합에 대해서는 하나의 판매 데이터만 존재합니다.

**문제 요구사항:**

`ONLINE_SALE` 테이블과 `OFFLINE_SALE` 테이블에서 2022년 3월의 오프라인/온라인 상품 판매 데이터를 결합하여 출력하세요. 이때, `OFFLINE_SALE` 테이블의 판매 데이터에 대한 `USER_ID` 값은 `NULL`로 표시해야 합니다. 결과는 `SALES_DATE`를 기준으로 오름차순 정렬하되, 판매일이 같은 경우에는 `PRODUCT_ID`를 기준으로 오름차순, 그리고 `PRODUCT_ID`가 같은 경우에는 `USER_ID`를 기준으로 오름차순 정렬해야 합니다.

**예시:**

- **ONLINE_SALE 테이블 예시 데이터:**

   | ONLINE_SALE_ID | USER_ID | PRODUCT_ID | SALES_AMOUNT | SALES_DATE |
   | -------------- | ------- | ---------- | ------------ | ---------- |
   | 1              | 1       | 3          | 2            | 2022-02-25 |
   | 2              | 4       | 4          | 1            | 2022-03-01 |
   | 4              | 2       | 2          | 2            | 2022-03-02 |
   | 3              | 6       | 3          | 3            | 2022-03-02 |
   | 5              | 5       | 5          | 1            | 2022-03-03 |
   | 6              | 5       | 7          | 1            | 2022-04-06 |

- **OFFLINE_SALE 테이블 예시 데이터:**

   | OFFLINE_SALE_ID | PRODUCT_ID | SALES_AMOUNT | SALES_DATE |
   | --------------- | ---------- | ------------ | ---------- |
   | 1               | 1          | 2            | 2022-02-21 |
   | 4               | 1          | 2            | 2022-03-01 |
   | 3               | 3          | 3            | 2022-03-01 |
   | 2               | 4          | 1            | 2022-03-01 |
   | 5               | 2          | 1            | 2022-03-03 |
   | 6               | 2          | 1            | 2022-04-01 |

- **결합 및 정렬된 결과 예시:**

   | SALES_DATE | PRODUCT_ID | USER_ID | SALES_AMOUNT |
   | ---------- | ---------- | ------- | ------------ |
   | 2022-03-01 | 1          | NULL    | 2            |
   | 2022-03-01 | 3          | NULL    | 3            |
   | 2022-03-01 | 4          | NULL    | 1            |
   | 2022-03-01 | 4          | 4       | 1            |
   | 2022-03-02 | 2          | 2       | 2            |
   | 2022-03-02 | 3          | 6       | 3            |
   | 2022-03-03 | 2          | NULL    | 1            |
   | 2022-03-03 | 5          | 5       | 1            |

```sql
SELECT DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT
FROM ONLINE_SALE
WHERE DATE_FORMAT(SALES_DATE, '%Y-%m') = '2022-03'
UNION ALL
SELECT DATE_FORMAT(SALES_DATE, '%Y-%m-%d') AS SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SALES_AMOUNT
FROM OFFLINE_SALE
WHERE DATE_FORMAT(SALES_DATE, '%Y-%m') = '2022-03'
ORDER BY SALES_DATE, PRODUCT_ID, USER_ID;
```
