---
title: "진료과별 총 예약 횟수 출력하기"
excerpt: "진료과별 총 예약 횟수 출력하기"

categories: SQL
tags:  SQL

permalink: /categories/진료과별 총 예약 횟수 출력하기/ # url

toc: true
toc_sticky: true

date: 2024-01-15
last_modified_at: 2024-01-15
---

# 진료과별 총 예약 횟수 출력하기

programmers SQL 고득점 kit 연습

## 진료 예약 정보 분석

### 문제 설명
종합병원의 진료 예약 정보를 담고 있는 `APPOINTMENT` 테이블이 있습니다. 이 테이블은 다음과 같은 구조로 되어 있습니다:

| Column name   | Type        | Nullable |
|---------------|-------------|----------|
| APNT_YMD      | TIMESTAMP   | FALSE    |
| APNT_NO       | NUMBER(5)   | FALSE    |
| PT_NO         | VARCHAR(10) | FALSE    |
| MCDP_CD       | VARCHAR(6)  | FALSE    |
| MDDR_ID       | VARCHAR(10) | FALSE    |
| APNT_CNCL_YN  | VARCHAR(1)  | TRUE     |
| APNT_CNCL_YMD | DATE        | TRUE     |

여기서 `APNT_YMD`, `APNT_NO`, `PT_NO`, `MCDP_CD`, `MDDR_ID`, `APNT_CNCL_YN`, `APNT_CNCL_YMD`는 각각 진료예약일시, 진료예약번호, 환자번호, 진료과코드, 의사ID, 예약취소여부, 예약취소날짜를 나타냅니다.

### 문제 요구사항
`APPOINTMENT` 테이블에서 2022년 5월에 예약한 환자 수를 진료과코드 별로 조회하는 SQL문을 작성해야 합니다. 이때, 결과 컬럼명은 '진료과 코드', '5월예약건수'로 지정하고, 결과는 진료과별 예약한 환자 수를 기준으로 오름차순 정렬하며, 예약한 환자 수가 같은 경우는 진료과 코드를 기준으로 추가적으로 오름차순 정렬해야 합니다.

### 예시 데이터
예를 들어, `APPOINTMENT` 테이블에 다음과 같은 데이터가 있다고 가정합니다:

| APNT_YMD                  | APNT_NO | PT_NO      | MCDP_CD | MDDR_ID   | APNT_CNCL_YN | APNT_CNCL_YMD |
|---------------------------|---------|------------|---------|-----------|--------------|---------------|
| 2022-04-14 09:30:00.000000| 47      | PT22000064 | GS      | DR20170123| N            | NULL          |
| 2022-04-15 10:30:00.000000| 48      | PT22000065 | OB      | DR20100231| N            | NULL          |
| 2022-05-15 17:30:00.000000| 49      | PT22000086 | OB      | DR20100231| N            | NULL          |
| 2022-05-18 10:30:00.000000| 52      | PT22000019 | GS      | DR20100039| N            | NULL          |
| 2022-05-19 12:00:00.000000| 53      | PT22000020 | FM      | DR20010112| N            | NULL          |
| 2022-05-22 08:30:00.000000| 54      | PT22000021 | GS      | DR20100039| N            | NULL          |
| 2022-05-04 10:30:

:00.000000| 56      | PT22000023 | FM      | DR20090112| N            | NULL          |
| 2022-05-14 15:30:00.000000| 57      | PT22000074 | CS      | DR20200012| N            | NULL          |
| 2022-05-24 15:30:00.000000| 58      | PT22000085 | CS      | DR20200012| N            | NULL          |
| 2022-05-28 10:00:00.000000| 60      | PT22000092 | OS      | DR20100031| N            | NULL          |

### 예상 출력
이 데이터에 대해 SQL을 실행하면, 다음과 같은 결과가 출력되어야 합니다:

| 진료과코드 | 5월예약건수 |
|------------|------------|
| OB         | 1          |
| OS         | 1          |
| CS         | 2          |
| FM         | 2          |
| GS         | 2          |

```sql
SELECT
    MCDP_CD as "진료과코드"
    , count(APNT_NO) as "5월예약건수"
from APPOINTMENT
where APNT_YMD like "2022-05-%"
group by MCDP_CD
order by 2 asc, 1 asc
```
